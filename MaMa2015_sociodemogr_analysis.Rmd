---
title: "Socio-demographic and -economic factors and malaria prevalence in case-control study in Mangalore, India, 2015"
author: "Welmoed van Loon"
date: "20 March 2020"
output:
  html_document:
    theme: flatly
    highlight: tango
    code_folding: "hide"
    toc: true
    toc_float: 
      collapsed: true
---


# Setup R-session
```{r setup, include = T, results = "hide", warning = F, message = F}

knitr::opts_chunk$set(warning = F, message= F)

if( !require(data.table) ){ install.packages("data.table") }
if( !require(tidyverse) ){ install.packages("tidyverse") }
if( !require(Amelia) ){ install.packages("Amelia") } 
if( !require(gtools) ){ install.packages("gtools") } 
if( !require(jtools) ){ install.packages("jtools") } 
if( !require(mice) ){ install.packages("mice") } 
if( !require(arsenal) ){ install.packages("arsenal") } 
if( !require(dagitty) ){ install.packages("dagitty") } 
if( !require(ggdag) ){ install.packages("ggdag") } 
if( !require(kableExtra) ){ install.packages("kableExtra") } 

setwd("C:/Users/W.A/Desktop/MaMa2015_sociodemogr/MaMa2015_sociodemogr_analysis_20200329")

# Load data:
dt_orig <- fread("MaMa2015_sociodemogr_data_prepared.csv", 
                 stringsAsFactors = T, header = TRUE, na.strings = c("", "NA")) %>%
  # order isco-categories, for pretty summary tables:
  mutate(Occup_isco = fct_relevel(Occup_isco, mixedsort(levels(.$Occup_isco)))) %>%
  arrange_if(is.factor) %>%
  as.data.table()

# Imputation settings:
seednr <- 123 # Set seed number to always obtain same results for stochastic events.
m <- 10 # Set Number of Imputations.
```



# Functions {.tabset}

## Print summary table

- Function to quickly generate a summary table, grouped by a variable.
- Function to nicely print summary tables.
- Function to nicely print tables created after pooled analysis.

```{r}
func_summtable <- function(data, by_var, summ_vars = "."){
  
  # default for summ_vars is "."
  # which means that all variables in the dataset will be summarized
  # (except for the by_variable, which is the grouping variable)
  
  summtable <- data %>%
    tableby(as.formula(paste(by_var, "~", summ_vars)), data = .,
            control = tableby.control(test = F,
                                      numeric.stats = c("N", "meansd", "medianrange"),
                                      cat.stats = c("N", "countpct")))
  
  return(summtable)
} 


func_printtable <- function(summtable){
  
  printtable <- summary(summtable, text = TRUE) %>%
    kable() %>%
    kable_styling(bootstrap_options = c("striped", "condensed"))
  
  return(printtable)
}

func_printglm <- function(pooledglm){
  
  printglm <- pooledglm %>%
    summary(., conf.int = T, conf.level = 0.95, exponentiate = T) %>%
    rownames_to_column(var = "variable") %>%
    dplyr::select(variable, `exp(estimate)` = estimate, `2.5 %`, `97.5 %`, 
                  statistic, df, P = `p.value`) %>%
    mutate_at(vars(c("exp(estimate)", "2.5 %", "97.5 %", 
                     "statistic", "df")), round, 2) %>%
    mutate_at(vars(c("P")), round, 3) %>%
    kable() %>%
    kable_styling(bootstrap_options = c("striped", "condensed"))
    
  return(printglm)
}
```
\pagebreak

## Alter variables and collapse catogeries

Specifically for the imputed datasets; we will first impute the data, and only then alter some variables by collapsing catogeries. A function makes it easier to do this alteration on all imputed datasets.
```{r}
func_alt_vars <- function(data){
  
  # Not all columns are present in each dataset, 
  # so use vars(one_of(...))) in the mutate_at() function

  data_prep <- data %>%
    
    # Make sure all numerical variables are numerical:
    mutate_at(vars(c(Age, income_HH, NoHH, NoRoom)), as.numeric) %>%
    # Overwrite calculations that have to be added after imputation:
    mutate(NoPR = NoHH/NoRoom) %>%
    # Better order of levels in ISCO:
    mutate(Occup_isco = fct_relevel(Occup_isco, mixedsort(levels(Occup_isco)))) %>%
    
    # Better catogeries:
    mutate(Roof_3cats = fct_collapse(Roof, 
                                     "4. poor quality" = c("4. metal sheet",
                                                           "3. mud",
                                                           "2. straw/thatch",
                                                           "1. hut")),
           Relig_4cats = fct_collapse(Religion,
                                      "3. other" = c("3. sikh", "4. jain")),
    
           Educ_3cats = fct_collapse(Educ,
                                     "3. puc or graduate and above" = c("3. puc",
                                                                        "4. graduate and above"),
                                     "1. none or <10th grade" = c("0. not attended",
                                                                  "1. <10th class")),
           Occup_2cats = fct_collapse(Occup_isco,
                                      "0. daily labor" = c("9. daily labor",
                                                          "10. construction worker"),
                                      "1. else" = c("0. armed force",
                                                    "2. professional",
                                                    "3. technician",
                                                    "4. clerk",
                                                    "5. service",
                                                    "6. agriculture",
                                                    "7. craft",
                                                    "8. machine operator",
                                                    "11. coolie",
                                                    "12. other",
                                                    "13. in education and/or <18 yrs",
                                                    "14. unemployed"))) %>%
    # re-order the columns:
    dplyr::select(ID, IDorig, patient_1_control_0, MalStat,
                  Sex, Age, starts_with("Relig"), starts_with("Educ"), 
                  income_HH, starts_with("Occup"), 
                  Migrant, starts_with("Origin"),
                  starts_with("Roof"), NoHH, NoRoom, NoPR, 
                  Electricity, Fan, Television, Fridge, Motorcycle, Radio, Bicycle,
                  MalBefore, MalFam,
                  StagWB, Mnet, Wnet, MrepLiq, SkinCre, RepCoil, Ins6M, everything())
    
  return(data_prep)
}
```
\pagebreak 



# Prepare data

This dataset will be used for imputation, so collapsing of some factors (i.e., better grouping of categories) is not done yet.

2 important changes in the data happen here:

1. The participants without a home are removed, because the controls were selected by approaching HOUSEHOLDS only, so remove the homeless participants (only cases).
2. The participants under 18 years old are removed, because it complicates the analaysis of "Education" as a variable when participants could still be their educational track.

```{r}
dt <- dt_orig %>% 
  dplyr::select(ID, IDorig, patient_1_control_0, MalStat, 
                Sex, Age, Religion, Educ, income_HH, Occup_isco, 
                Migrant, Origin_3cats, Origin_9cats, 
                Roof, NoHH, NoRoom, NoPR, 
                Electricity, Fan, Television, Fridge, Motorcycle, Radio, Bicycle,
                MalBefore, MalFam,
                StagWB, Mnet, Wnet, MrepLiq, SkinCre, RepCoil, Ins6M) %>% 
  # 2 important exclusion criteria:
  filter(NoRoom > 0 | is.na(NoRoom)) %>%
  filter(Age >= 18 | is.na(Age)) %>%
  # 2 Important alterations for smooth and correct imputation:
  mutate_if(is.factor, fct_drop) %>% 
  mutate_if(.predicate = function(x){ all(x == 0 | x == 1 | is.na(x)) },
            .funs = function(x){ as.factor(as.character(x)) }) %>%
  as.data.table()
```
\pagebreak



# Summary of excluded data {.tabset}

## Age < 18
```{r}
dt_orig %>%
  filter(Age < 18) %>%
  dplyr::select(patient_1_control_0, Age, Educ, Occup_isco) %>%
  func_summtable(., by_var = "patient_1_control_0") %>%
  func_printtable(.)
```
\pagebreak

## Homeless
```{r}
dt_orig %>%
  filter(NoRoom == 0) %>%
  dplyr::select(patient_1_control_0, Roof, Educ, Occup_isco) %>%
  func_summtable(., by_var = "patient_1_control_0") %>%
  func_printtable(.)
```
\pagebreak




# Missingness pattern
```{r}
par(cex.main = 0.8)
dt %>%
  as.data.frame() %>%
  missmap(., y.cex = 0.3, 
          main = paste("Missing values vs. observed, \nn = ", nrow(dt), ", ", 
                       "complete observation n = ", nrow(na.omit(dt)), sep = ""))
```
\pagebreak



# Models {.tabset}
 
Causal questions:

1. Malaria ~ Level of completed education
2. Malaria ~ Migrant (i.e. not originating from Mangaluru)
3. Malaria ~ IRS past 6 months
4. Malaria ~ Roof type

NB: Malaria = patient/control, i.e., acute symptomatic malaria yes versus randomly chosen control from population with possible asymptomatic malaria

## For total effect

Variables to include in the model for estimating the TOTAL EFFECT of the variable of interest, following the DAG:

1. Malaria ~ Education + Sex + Age + Religion + Early Life SES

2. Malaria ~ Migrant + Sex + Age + Education + Religion

3. Malaria ~ IRS past 6 months + Education + Migrant + Roof

4. Malaria ~ Roof + Education + Migrant + Occupation + Income

NB: Early Life SES is an unobserved variables and cannot be included.
NB: Occupation will be grouped into 2 catogeries: construction worker/daily laborer and anything else.

## For direct effect

Variables to include in the model for estimating the DIRECT EFFECT of the variable of interest, following the DAG:

1. **Malaria ~ Education** + Sex + Age + Religion + Income + Occupation + Migrant + Roof + Malaria history + Malaria history in family + IRS past 6 months + Preventive measures 

2. **Malaria ~ Migrant** + Sex + Age + Religion + Income + Occupation + Roof + Nr of people per room + Malaria history + Malaria history in family + IRS past 6 months + Preventive measures 

3. **Malaria ~ IRS past 6 months** + Income + Education + Migrant + Roof + Malaria history + Malaria history in family + Preventive measures

4. **Malaria ~ Roof** + Income + Occupation + Education +  Migrant + Malaria history + Malaria history in family + IRS past 6 months + Preventive measures 

NB: Preventive measures includes Mosquito net + Window net + Repellent coil + Repellent liqiud + Repellent skin cream.
NB: For the analysis, occupation will be grouped into 2 catogeries: construction worker/daily laborer and anything else.



# Variable-set for imputation {.tabset}

General rules

Three guidelines for inclusion as predictors:

1) Variables that are in the model, including the outcome
2) Variables that create missingness in the variables to impute (only if not too many missingness themselves)
3) Variables that are informative for the value of the variables to impute (only if not too many missingness themselves)

## For total effects

patient_1_control_0, Educ, Migrant, Roof, Ins6M, 
Sex, Age, Religion, Occup_isco, income_HH, NoHH, 
Fan, Fridge , Television, Radio, Bicycle, Motorcycle

## For direct effects

patient_1_control_0, Educ, Migrant, Roof, Ins6M,
Sex, Age, Religion, Occup_isco, income_HH, NoHH, NoRoom,
MalFam, MalBefore,
Mnet, Wnet, RepCoil, MrepLiq, SkinCre,
Fan, Fridge , Television, Radio, Bicycle, Motorcycle



# Impute data

## Imputation {.tabset}

### For the total effects -models
```{r, eval = F}
# This code chunck can be skipped (eval = FALSE) if the imputed dataset is already available:

# Prepare predictor matrix:
excl_TE <- c("ID", "IDorig", "Origin_3cats", "Origin_9cats","NoPR", "MalFam", "MalBefore",
             "Mnet", "Wnet", "RepCoil", "MrepLiq", "SkinCre")
ini_TE <- mice(dt, maxit = 0) # dry run without iterations to get the predictor matrix
pred_TE <- ini_TE$predictorMatrix # the predictor matrix
meth_TE <- ini_TE$meth
meth_TE[excl_TE] <- "" # set all column values to zero to exclude it from being predicted
pred_TE[,excl_TE] <- 0 # set all column values to zero to exclude it as a predictor

# Impute:
dt_imp_TE_classmids <- mice(data = dt, pred = pred_TE, method = meth_TE, seed = seednr, m = m, maxit = 10)
                            
# In case MICE found pecularities:
dt_imp_TE_classmids$loggedEvents
```

### For the direct effects -models
```{r, eval = F}
# This code chunck can be skipped (eval = FALSE) if the imputed dataset is already available:

# Prepare predictor matrix:
excl_DE <- c("ID", "IDorig", "Origin_3cats", "Origin_9cats","NoPR")
ini_DE <- mice(dt, maxit = 0) # dry run without iterations to get the predictor matrix
pred_DE <- ini_DE$predictorMatrix # the predictor matrix
meth_DE <- ini_DE$meth
meth_DE[excl_DE] <- "" # set all column values to zero to exclude it from being predicted
pred_DE[,excl_DE] <- 0 # set all column values to zero to exclude it as a predictor

# Impute:
dt_imp_DE_classmids <- mice(data = dt, pred = pred_DE, method = meth_DE, seed = seednr, m = m, maxit = 10)
                            
# In case MICE found pecularities:
dt_imp_DE_classmids$loggedEvents
```

## Store or load imputed data

A dataset of long format is stored, with all imputed datasets stacked on each other. The imputation "ID" is given in column ".imp". All observations with imp = 0 belong to the unimputed dataset (i.e., the first ~3000 rows).
```{r, eval = F}
# Store in long, rectangular dataframe-format:

dt_imp_TE_long <- complete(dt_imp_TE_classmids, "long", include = T) 
dt_imp_DE_long <- complete(dt_imp_DE_classmids, "long", include = T) 
# inlcude = T means: include the non-imputed data (.imp = 0)

write_csv(dt_imp_TE_long, "MaMa2015_sociodemogr_data_imputed_totaleffects.csv")
write_csv(dt_imp_DE_long, "MaMa2015_sociodemogr_data_imputed_directeffects.csv")
```

```{r}
dt_imp_TE_long <- fread("MaMa2015_sociodemogr_data_imputed_totaleffects.csv", stringsAsFactors = T)
dt_imp_DE_long <- fread("MaMa2015_sociodemogr_data_imputed_directeffects.csv", stringsAsFactors = T)
```
\pagebreak

## Prepare imputed data for analaysis

2 actions happen here:

1. In some variables (e.g., education, roof, occupation), categories are grouped ("collapsed") into better categories for the analysis. A function is used for this. 

2. The dataset in long format is changed into class "mids", which is a class specifically for imputed datasets (MICE package), which will make pooled analysis easier.

```{r}
dt_imp_TE_prep <- dt_imp_TE_long %>%
  # collapse some categories in some variables:
  func_alt_vars(.) %>% 
  # Make sure all 0/1 varaibles are factors and not numerical:
  mutate_if(.predicate = function(x){ all(x == 0 | x == 1, na.rm = T) },
            .funs = function(x){ as.factor(as.character(x)) }) %>%
  as.mids(.)

dt_imp_DE_prep <- dt_imp_DE_long %>%
  # collapse some categories in some variables:
  func_alt_vars(.) %>% 
  # Make sure all 0/1 varaibles are factors and not numerical:
  mutate_if(.predicate = function(x){ all(x == 0 | x == 1, na.rm = T) },
            .funs = function(x){ as.factor(as.character(x)) }) %>%
  as.mids(.)
```
\pagebreak



# Summary prepared, unimputed data {.tabset}

## Distribution numerical vars
```{r}
vars_numberic <- dt_imp_DE_prep$data %>% # the unimputed dataset (is same for TE and DE)
  select_if(is.numeric) %>% names(.)

dt_imp_DE_prep$data %>% # the unimputed dataset (is same for TE and DE)
  dplyr::select(patient_1_control_0, vars_numberic) %>%
  gather(key = variable, value = value, -"patient_1_control_0", -"ID") %>%
  
  ggplot() +
  geom_density(aes(value, fill = patient_1_control_0), alpha = 1/2) +
  facet_wrap(~variable, scales = "free", ncol = 2) +
  theme_light()
```
\pagebreak

## By patient/control
```{r}
dt_imp_DE_prep$data %>% # the unimputed dataset (is same for TE and DE)
  dplyr::select(-ID, -IDorig) %>%
  #func_summtable(by_var = "patient_1_control_0") %>%
  tableby(patient_1_control_0 ~ ., data = ., 
          numeric.stats = c("N", "meansd", "medianrange"),
          cat.stats = c("N", "countpct"),
          cat.test="fe", numeric.test = "kwt", simulate.p.value = T) %>%
  func_printtable()
```
\pagebreak

## Origin
```{r}
dt_imp_DE_prep$data %>% # the unimputed dataset (is same for TE and DE)
  dplyr::select(Origin_3cats, patient_1_control_0) %>%
  func_summtable(by_var = "patient_1_control_0") %>%
  func_printtable()
```
\pagebreak

```{r}
dt_imp_DE_prep$data %>% # the unimputed dataset (is same for TE and DE)
  dplyr::select(Origin_9cats, Origin_3cats) %>%
  func_summtable(by_var = "Origin_3cats") %>%
  func_printtable()
```
\pagebreak


## Migrant workers, NoHH & NoRoom {.tabset}
### Figures
```{r}
dt_imp_DE_prep$data %>% # the unimputed dataset (is same for TE and DE)
  filter(NoRoom < 9 & !is.na(Migrant) & !is.na(Occup_2cats) & !is.na(NoHH)) %>%
  ggplot() +
  geom_jitter(aes(x = as.factor(NoRoom), y = NoHH, color = Migrant, shape = Occup_2cats),
              width = 0.4, height = 0, size = 2, alpha = 3/4) +
  scale_shape_manual(values = c(19, 8)) +
  scale_y_log10() +
  theme_bw() +
  theme(legend.position = "bottom")
```

### Summary table of "households" > 10 persons
```{r}
dt_imp_DE_prep$data %>% # the unimputed dataset (is same for TE and DE)
  filter(NoHH > 10) %>%
  dplyr::select(Occup_isco, Migrant) %>%
  func_summtable(by_var = "Migrant") %>%
  func_printtable()
```
\pagebreak

## SES and Ins6M {.tabset}

### Figures
```{r}
dt_imp_DE_prep$data %>% # the unimputed dataset (is same for TE and DE)
  filter(income_HH > 100 & !is.na(Ins6M) & !is.na(Migrant) & !is.na(Occup_isco)) %>%
  ggplot() +
  geom_jitter(aes(x = as.factor(Ins6M), y = income_HH, color = Migrant, shape = Occup_2cats),
              width = 0.4, height = 0, size = 2, alpha = 3/4) +
  scale_shape_manual(values = c(19, 8)) +
  scale_y_log10() +
  theme_bw() +
  theme(legend.position = "bottom")
```

### Summary table by Ins6M
```{r}
dt_imp_DE_prep$data %>% # the unimputed dataset (is same for TE and DE)
  dplyr::select(income_HH, Migrant, Occup_isco, Ins6M) %>%
  tableby(Ins6M ~ ., data = ., 
          numeric.stats = c("N", "meansd", "medianrange"),
          cat.stats = c("N", "countpct"),
          cat.test="fe", numeric.test = "kwt", simulate.p.value = T) %>%
  func_printtable()
```
\pagebreak

### Summary table by Migrant, Ins6M = 0
```{r}
dt_imp_DE_prep$data %>% # the unimputed dataset (is same for TE and DE)
  filter(Ins6M == 0) %>%
  dplyr::select(Occup_isco, Migrant) %>%
  func_summtable(by_var = "Migrant") %>%
  func_printtable()
```
\pagebreak



# Summary imputed datasets {.tabset}

## Total effects
```{r}
dt_imp_TE_prep %>%
  complete("long", include = T) %>% 
  filter(.imp %in% c(0:10)) %>%
  dplyr::select(-.id, -Occup_isco, -ID, -IDorig) %>%
  tableby(.imp ~ ., data = .,
          control = tableby.control(test = F, total = F,
                                    numeric.stats = c("Nmiss", "meansd", "medianrange"),
                                    cat.stats = c("Nmiss", "countpct"))) %>%
  func_printtable()
```
\pagebreak

## Direct effects
```{r}
dt_imp_DE_prep %>%
  complete("long", include = T) %>% 
  filter(.imp %in% c(0:10)) %>%
  dplyr::select(-.id, -Occup_isco, -ID, -IDorig) %>%
  tableby(.imp ~ ., data = .,
          control = tableby.control(test = F, total = F,
                                    numeric.stats = c("Nmiss", "meansd", "medianrange"),
                                    cat.stats = c("Nmiss", "countpct"))) %>%
  func_printtable()
```
\pagebreak



# Analysis {.tabset}

## Educ {.tabset}

### Total effect

Malaria ~ Educ + Sex + Age + Religion + Early Life SES

```{r}
model_educ_TE <- with(data = dt_imp_TE_prep, 
                      exp = glm(patient_1_control_0 ~ Educ_3cats + Sex + Age + Relig_4cats, 
                                family = "binomial"))

# Print relevant summary
pool(model_educ_TE) %>% func_printglm(.)
```
\pagebreak 

### Direct effect

Malaria ~ Educ + Sex + Age + Religion +  income_HH + Occup_2cats + Migrant + Roof + MalFam + MalBefore + Ins6M + Mnet + Wnet + RepCoil + MrepLiq + SkinCre

```{r}
model_educ_DE <- with(data = dt_imp_DE_prep, 
                      exp = glm(patient_1_control_0 ~ Educ_3cats + Sex + Age + Relig_4cats +
                                  income_HH + Occup_2cats +
                                  Migrant + Roof_3cats + MalFam + MalBefore +
                                  Ins6M + Mnet + Wnet + RepCoil + MrepLiq + SkinCre, 
                                family = "binomial"))

# Print relevant summary
pool(model_educ_DE) %>% func_printglm()
```

## Migrant {.tabset}

### Total effect

Malaria ~ Migrant + Sex + Age + Educ + Religion

```{r}
model_migr_TE <- with(data = dt_imp_TE_prep, 
                      exp = glm(patient_1_control_0 ~ Migrant + Sex + Age + Educ_3cats + Relig_4cats,
                                family = "binomial"))

# Print relevant summary
pool(model_migr_TE) %>% func_printglm()
```
\pagebreak 

### Direct effect

Malaria ~ Migrant + Migrant + Sex + Age + Religion + income_HH + Occup_2cats + Educ + Roof + NoPR + MalFam + MalBefore + Ins6M + Mnet + Wnet + RepCoil + MrepLiq + SkinCre

```{r}
model_migr_DE <- with(data = dt_imp_DE_prep, 
                          exp = glm(patient_1_control_0 ~ Migrant + Sex + Age + Relig_4cats +
                                      income_HH + Occup_2cats + Educ_3cats +
                                      Roof_3cats + NoPR + MalFam + MalBefore +
                                      Ins6M + Mnet + Wnet + RepCoil + MrepLiq + SkinCre, 
                                    family = "binomial"))

# Print relevant summary
pool(model_migr_DE) %>% func_printglm()
```
\pagebreak 

## Roof {.tabset}

### Total effect

Malaria ~ Roof + Educ + Migrant + Occup_2cats + income_HH

```{r}
model_roof_TE <- with(data = dt_imp_TE_prep,
                       exp = glm(patient_1_control_0 ~ Roof_3cats + Educ_3cats + Migrant + 
                                   Occup_2cats + income_HH,
                                 family = "binomial"))

# Print relevant summary
pool(model_roof_TE) %>% func_printglm
```
\pagebreak 

### Direct effect

Malaria ~ Roof_3cats + income_HH + + Occup_2cats + Educ_3cats + Migrant + MalFam + MalBefore + Ins6M + Mnet + Wnet + RepCoil + MrepLiq + SkinCre

```{r}
model_roof_DE <- with(data = dt_imp_DE_prep,
                       exp = glm(patient_1_control_0 ~ Roof_3cats + 
                                  income_HH + + Occup_2cats + Educ_3cats + 
                                  Migrant + MalFam + MalBefore + 
                                  Ins6M + Mnet + Wnet + RepCoil + MrepLiq + SkinCre,
                                 family = "binomial"))

# Print relevant summary
pool(model_roof_DE) %>% func_printglm
```
\pagebreak 

## Ins6M {.tabset}

### Total effect

Malaria ~ Ins6M + Educ + Migrant + Roof

```{r}
model_ins6m_TE <- with(data = dt_imp_TE_prep, 
                       exp = glm(patient_1_control_0 ~ Ins6M + Educ_3cats + Migrant + Roof_3cats, 
                                 family = "binomial"))

# Print relevant summary
pool(model_ins6m_TE) %>% func_printglm
```
\pagebreak 

### Direct effect

Malaria ~ Ins6M + income_HH + Educ_3cats + Migrant + Roof_3cats + MalFam + MalBefore + Mnet + Wnet + RepCoil + MrepLiq + SkinCre

```{r}
model_ins6m_DE <- with(data = dt_imp_DE_prep, 
                       exp = glm(patient_1_control_0 ~ Ins6M + income_HH + Educ_3cats + 
                                   Migrant + Roof_3cats + 
                                   MalFam + MalBefore + 
                                   Mnet + Wnet + RepCoil + MrepLiq + SkinCre, 
                                 family = "binomial"))

# Print relevant summary
pool(model_ins6m_DE) %>% func_printglm
```
\pagebreak 